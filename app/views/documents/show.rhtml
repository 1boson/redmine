<h2><%= @document.title %></h2>

<p><em><%= @document.category.name %><br />
<%= format_date @document.created_on %></em></p>
<%= textilizable @document.description %>


<table width="100%">
<tr><td><%= link_to_if_authorized l(:button_edit), :controller => 'documents', :action => 'edit', :id => @document %></td>
<td align="right">
<% if authorize_for('documents', 'destroy') %>
  <%= start_form_tag({ :controller => 'documents', :action => 'destroy', :id => @document } ) %>
  <%= submit_tag l(:button_delete) %>
  <%= end_form_tag %>
<% end %>
</td></tr>
</table>
<br />

<h3><%= l(:label_attachment_plural) %></h3>
<ul>  
<% for attachment in @attachments %>
    <li>
        <% if authorize_for('documents', 'destroy_attachment') %>
        <div style="float:right;padding:6px;">
        <%= start_form_tag({ :controller => 'documents', :action => 'destroy_attachment', :id => @document, :attachment_id => attachment } ) %>
        <%= submit_tag l(:button_delete), :class => 'button-small' %>
         <%= end_form_tag %>
         </div>
         <% end %>

        <%= link_to attachment.filename, :action => 'download', :id => @document, :attachment_id => attachment %>
        (<%= human_size attachment.filesize %>)<br />
        <em><%= attachment.author.display_name %>, <%= format_date(attachment.created_on) %></em><br />
        <%= lwr(:label_download, attachment.downloads) %>
    </li>
<% end %>
</ul>
<br />


<% if authorize_for('documents', 'add_attachment') %>
  <%= start_form_tag ({ :controller => 'documents', :action => 'add_attachment', :id => @document }, :multipart => true) %>
  <label><%=l(:label_attachment_new)%></label>&nbsp;&nbsp;
  <%= file_field 'attachment', 'file'  %>
  <%= submit_tag l(:button_add) %>
  <%= end_form_tag %> 
<% end %>
